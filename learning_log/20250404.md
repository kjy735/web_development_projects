# 금일 수업계획
## 환경변수를 적용한 리팩토링
서버 URL은 더 많은 CRUD 기능을 만들 때 소스 코드에서 여러 번 반복될 수 있으며 백엔드가 localhost가 아닌 다른 서버에 배포될 때 변경될 수 있기 때문에 환경변수로 정의하는 편이 안전함. 그럴 경우 URL이 바뀌더라도 한 번만 수정하면 되기 때문 -> 즉 하드코딩을 최대한 줄일 것

vite 프로젝트를 사용한다면, 환경변수 이름은
VITE_로 시작해야 합니다. 접두사가 VITE_인 변수만 소스 코드에서 접근이 가능합니다.

carfront(가장상단)에 우클릭 -> new file -> .env
```java
VITE_API_URL=http://localhost:8080
```

여기저기 흩어져있는 API 호출 함수들을 자체 모듈로 분리
src -> new folder -> api -> carapi.ts

Carlist.tsx 파일 내부에서 getCars 함수를 분리해올겁니다.
그리고 다른 컴포넌트에서도 이용하라 수 있도록 export도 추가할겁니다.
비트에서 환경변수는 import.meta.n=env를 통해 앱 소스코드를 문자열로 접근이 가능합니다. 그런 다음 서버 URL을 통해 getCars 함수로 가져와서 이용 가능합니다.
전역적으로 사용할 예정이니 axios와 CarResponse 타입도 carapi.ts로 임포트할 필요성 있음.

## 페이징, 필터링, 정렬추가(가능하다면)
기존 버전 삭제
npm uninstall @mui/material @mui/x-data-grid

MUI 5.17 버전 설치
npm install #mui/material@5.17.1 @emotion/react@11.14.0 @emotion/styled@11.14.0

data-grid 재설치
npm install @mui/x-data-grid@6.20.4

다했으면 앱 다시 껐다 켜
ctrl + c하면 꺼짐

```tsx
import { CarResponse } from "../types";
import { useQuery } from "@tanstack/react-query";
import { getCars } from "../api/carapi";
import { DataGrid, GridColDef } from "@mui/x-data-grid"; // 데이터를 그리드 모양으로 나타내줌, 그리드의 컬럼명 지정

function Carlist() {

  const { data, error, isSuccess } = useQuery({
    queryKey: ["cars"],
    queryFn: getCars
  });

  const columns : GridColDef[] = [
    {field: 'brand', headerName: "Brand", width: 200},
    {field: 'model', headerName: "Model", width: 200},
    {field: 'color', headerName: "Color", width: 200},
    {field: 'registrationNumber', headerName: "Reg.nr", width: 150},
    {field: 'modelYear', headerName: "Model Year", width: 150},
    {field: 'price', headerName: "Price", width: 150},
  ]


  if(!isSuccess) {
    return <span>Loading...</span>
  }
  else if(error) {
    return <span>⚠️자동차 데이터 가져오기 중 오류 발생⚠️</span>
  }
  else {
    return (
      <table>
        <tbody>
          {
            data.map((car: CarResponse) => 
            <tr key={car._links.self.href}>
              <td>{car.brand}</td>
              <td>{car.model}</td>
              <td>{car.color}</td>
              <td>{car.registrationNumber}</td>
              <td>{car.modelYear}</td>
              <td>{car.price}</td>
            </tr>
            )
          }
        </tbody>
      </table>
    )
  }
}

export default Carlist;
```
GridColDef 정의 후에는 
기존 return 내에서의 table을 삭제해야 하므로 남겨놓음

```tsx
return (
    <DataGrid 
      rows={data}
      columns={columns}
      getRowId={row => row._links.self.href}
      />
    );
```
DataGrid의 내부에 {rows, columns, getRowId} -> props drilling

## 삭제기능 구현